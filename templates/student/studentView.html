<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard</title>

    <!-- Fonts and Bootstrap -->
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&display=swap" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet" />
    <link rel="stylesheet" href="style.css" />
    <!-- ApexCharts CDN -->
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <style>
        /* body {
            font-family: Arial, sans-serif;
            background: #1e1e2f;
            color: #fff;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
        } */
        /* body{
            background-color: #1e1e2f;
            color: brown;
         } */

        .chart {
            width: 400px;
            background: #2c2c3e;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
        }

        .chart1 {
            width: 400px;
            background: #2c2c3e;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
        }

        .chart-container {
            display: flex;
            flex-wrap: wrap;
            /* stack on small screens */
            gap: 20px;
            width: 100%;
            max-width: 100%;
            margin: 1rem auto;
            box-sizing: border-box;
            justify-content: center;
            padding: 20px;
        }

        .chart-title {
            text-align: center;
            font-size: 24px;
            margin-bottom: 20px;
            color: #00e5ff;
        }
    </style>
</head>

<body class="bg-dark text-white">

    <!-- Header -->
    <header class="navbar sticky-top bg-dark flex-md-nowrap p-0 shadow">
        <a class="navbar-brand col-md-3 col-lg-2 me-0 px-3 fs-6 text-white" href="#">Company Name</a>
        <ul class="navbar-nav flex-row d-md-none">
            <!-- <li class="nav-item text-nowrap">
                <button class="nav-link px-3 text-white" type="button" data-bs-toggle="collapse"
                    data-bs-target="#navbarSearch" aria-controls="navbarSearch" aria-expanded="false"
                    aria-label="Toggle search">
                    <i class="bi bi-search"></i>
                </button>
            </li> -->
            <li class="nav-item text-nowrap">
                <button class="nav-link px-3 text-white" type="button" data-bs-toggle="collapse"
                    data-bs-target="#sidebarMenu" aria-controls="sidebarMenu" aria-expanded="false"
                    aria-label="Toggle navigation">
                    <i class="bi bi-list"></i>
                </button>
            </li>

        </ul>
        <!-- <div id="navbarSearch" class="navbar-search w-100 collapse">
            <input class="form-control w-100 rounded-0 border-0" type="text" placeholder="Search" aria-label="Search" />
        </div> -->
    </header>

    <div class="container-fluid">
        <div class="row">
            <!-- Main Layout -->
            <div class="container-fluid">
                <div class="row">

                    <!-- Sidebar -->
                    <nav id="sidebarMenu"
                        class="col-md-3 col-lg-2 d-md-block bg-dark sidebar collapse border-end border-secondary">
                        <div class="position-sticky pt-3 sidebar-sticky">
                            <ul class="nav flex-column">
                                <li class="nav-item">
                                    <a class="nav-link active text-white" href="#">
                                        <i class="bi bi-house-fill me-2"></i> Dashboard
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link text-white" href="/profile">
                                        <i class="bi bi-person-fill"></i> profile
                                    </a>
                                </li>
                                <!-- <li class="nav-item">
                                    <a class="nav-link text-white" href="#">
                                        <i class="bi bi-cart me-2"></i> Products
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link text-white" href="#">
                                        <i class="bi bi-people me-2"></i> Customers
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link text-white" href="#">
                                        <i class="bi bi-graph-up me-2"></i> Reports
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link text-white" href="#">
                                        <i class="bi bi-puzzle me-2"></i> Integrations
                                    </a>
                                </li> -->
                            </ul>

                            <h6 class="text-white px-3 mt-4 mb-1">Saved Reports</h6>
                            <ul class="nav flex-column mb-2">
                                <li class="nav-item">
                                    <a class="nav-link text-white" href="#"><i class="bi bi-file-earmark-text me-2"></i>
                                        Current month</a>
                                </li>
                                <!-- <li class="nav-item">
                                    <a class="nav-link text-white" href="#"><i class="bi bi-file-earmark-text me-2"></i>
                                        Last
                                        quarter</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link text-white" href="#"><i class="bi bi-file-earmark-text me-2"></i>
                                        Social
                                        engagement</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link text-white" href="#"><i class="bi bi-file-earmark-text me-2"></i>
                                        Year-end sale</a>
                                </li> -->
                            </ul>

                            <hr class="border-secondary" />

                            <ul class="nav flex-column mb-auto">
                                <!-- <li class="nav-item">
                                    <a class="nav-link text-white" href="#">
                                        <i class="bi bi-gear-wide-connected me-2"></i> Settings
                                    </a>
                                </li> -->
                                <li class="nav-item">
                                    <a class="nav-link text-white" href="/singout">
                                        <i class="bi bi-door-closed me-2"></i> Sign out
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link text-white" href="/student_home">
                                        <i class="bi bi-arrow-left-short"></i> Back
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </nav>

                    <!-- Main content area -->
                    <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                        <div
                            class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-1 pb-1 mb-2 border-bottom">
                            <h1 class="h4 mb-0">Dashboard</h1> <!-- Smaller heading -->
                            <div class="btn-toolbar mb-1">
                                <div class="btn-group me-2">
                                    <button id="notifi1" type="button"
                                        class="btn btn-sm btn-outline-secondary">Share</button>
                                    <button id="notifi2" type="button"
                                        class="btn btn-sm btn-outline-secondary">Export</button>
                                </div>
                                <button id="notifi3" type="button"
                                    class="btn btn-sm btn-outline-secondary dropdown-toggle d-flex align-items-center">
                                    <svg class="bi" width="16" height="16" aria-hidden="true">
                                        <use xlink:href="#calendar3"></use>
                                    </svg>
                                    <span class="ms-1">This week</span>
                                </button>
                            </div>
                        </div>
                        <div class="my-4 w-100 chart-container" id="myChart" width="2068" height="873"
                            style="display: block; box-sizing: border-box; width: 1034px;display: flex;">
                            <div class="chart"></div>
                            <div class="chart1" style="color: #2c2c3e;">
                                <div class="chart-title">Country-wise Data</div>
                            </div>
                        </div>
                        <h2>Section title</h2>
                        <div class="table-responsive small">
                            <table class="table table-striped table-sm">
                                <thead>
                                    <tr>
                                        <th scope="col">Roll No</th>
                                        <th scope="col">Email</th>
                                        <th scope="col">Time</th>
                                        <th scope="col">Present</th>
                                        <th scope="col">Header</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for i in acdata %}
                                    {% set ns = namespace(ispres=false, datet=None) %}
                                    <tr>
                                        <td>{{ dID }}</td>
                                        <td>{{ email }}</td>

                                        {% for j in data %}
                                        {% if not ns.ispres and j.attend_time | within_5_minutes(i.time_start) %}
                                        {% set ns.datet = j.attend_time %}
                                        {% set ns.ispres = true %}
                                        {% endif %}
                                        {% endfor %}

                                        {% if ns.ispres %}
                                        <td>{{ ns.datet }}</td>
                                        <td><i class="bi bi-check2-circle"></i></td>
                                        <td>Present</td>
                                        {% else %}
                                        <td>---</td>
                                        <td><i class="bi bi-exclamation-octagon"></i></td>
                                        <td>Absent</td>
                                        {% endif %}
                                    </tr>
                                    {% endfor %}




                                    <!-- <tr>
                                        <td>1,002</td>
                                        <td>placeholder</td>
                                        <td>irrelevant</td>
                                        <td>visual</td>
                                        <td>layout</td>
                                    </tr>
                                    <tr>
                                        <td>1,003</td>
                                        <td>data</td>
                                        <td>rich</td>
                                        <td>dashboard</td>
                                        <td>tabular</td>
                                    </tr>
                                    <tr>
                                        <td>1,003</td>
                                        <td>information</td>
                                        <td>placeholder</td>
                                        <td>illustrative</td>
                                        <td>data</td>
                                    </tr>
                                    <tr>
                                        <td>1,004</td>
                                        <td>text</td>
                                        <td>random</td>
                                        <td>layout</td>
                                        <td>dashboard</td>
                                    </tr>
                                    <tr>
                                        <td>1,005</td>
                                        <td>dashboard</td>
                                        <td>irrelevant</td>
                                        <td>text</td>
                                        <td>placeholder</td>
                                    </tr>
                                    <tr>
                                        <td>1,006</td>
                                        <td>dashboard</td>
                                        <td>illustrative</td>
                                        <td>rich</td>
                                        <td>data</td>
                                    </tr>
                                    <tr>
                                        <td>1,007</td>
                                        <td>placeholder</td>
                                        <td>tabular</td>
                                        <td>information</td>
                                        <td>irrelevant</td>
                                    </tr>
                                    <tr>
                                        <td>1,008</td>
                                        <td>random</td>
                                        <td>data</td>
                                        <td>placeholder</td>
                                        <td>text</td>
                                    </tr>
                                    <tr>
                                        <td>1,009</td>
                                        <td>placeholder</td>
                                        <td>irrelevant</td>
                                        <td>visual</td>
                                        <td>layout</td>
                                    </tr>
                                    <tr>
                                        <td>1,010</td>
                                        <td>data</td>
                                        <td>rich</td>
                                        <td>dashboard</td>
                                        <td>tabular</td>
                                    </tr>
                                    <tr>
                                        <td>1,011</td>
                                        <td>information</td>
                                        <td>placeholder</td>
                                        <td>illustrative</td>
                                        <td>data</td>
                                    </tr>
                                    <tr>
                                        <td>1,012</td>
                                        <td>text</td>
                                        <td>placeholder</td>
                                        <td>layout</td>
                                        <td>dashboard</td>
                                    </tr>
                                    <tr>
                                        <td>1,013</td>
                                        <td>dashboard</td>
                                        <td>irrelevant</td>
                                        <td>text</td>
                                        <td>visual</td>
                                    </tr>
                                    <tr>
                                        <td>1,014</td>
                                        <td>dashboard</td>
                                        <td>illustrative</td>
                                        <td>rich</td>
                                        <td>data</td>
                                    </tr>
                                    <tr>
                                        <td>1,015</td>
                                        <td>random</td>
                                        <td>tabular</td>
                                        <td>information</td>
                                        <td>text</td>
                                    </tr> -->
                                </tbody>
                            </table>
                        </div>
                    </main>

                </div>
            </div>

            <!-- dastboad navbar -->

        </div>
    </div>


    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.getElementById('notifi1').addEventListener('click', () => {
            alert("Under constraction");
        })
        document.getElementById('notifi2').addEventListener('click', () => {
            alert("Under constraction");
        })
        document.getElementById('notifi3').addEventListener('click', () => {
            alert("Under constraction");
        })
    </script>

    <!-- for matplot -->
    <script>
        // ðŸŽ¯ Set attendance value here (can also come from backend dynamically)
        var attendanceValue = {{ length | tojson }};
        // console.log(attendanceValue)

        // âœ… Set color conditionally
        var textColor = attendanceValue < 30 ? '#ff4d4d' : '#00ffff';  // red or cyan

        var options = {
            series: [attendanceValue],
            chart: {
                height: 350,
                type: 'radialBar',
            },
            plotOptions: {
                radialBar: {
                    hollow: {
                        size: '70%',
                    },
                    dataLabels: {
                        name: {
                            show: true,
                            color: '#aaa',
                        },
                        value: {
                            show: true,
                            fontSize: '28px',
                            fontWeight: 'bold',
                            color: textColor  // ðŸŽ¨ Color based on condition
                        }
                    }
                }
            },
            labels: ['Attendance'],
        };

        var chart = new ApexCharts(document.querySelector(".chart"), options);
        chart.render();
    </script>

    <!-- for right graph -->
    <script>
        var options = {
            series: [{
                data: {{ count_list | tojson }}
            }],
        chart: {
            type: 'bar',
                height: 350,
                    background: '#2c2c3a',
                        foreColor: '#ffffff'
        },
        plotOptions: {
            bar: {
                borderRadius: 4,
                    borderRadiusApplication: 'end',
                        horizontal: true,
                }
        },
        dataLabels: {
            enabled: false
        },
        xaxis: {
            categories: [
                '1-7', '8-14', '15-21', '21-rem'
            ],
            },
        tooltip: {
            theme: 'dark'
        }
        };

        var chart = new ApexCharts(document.querySelector(".chart1"), options);
        chart.render();
    </script>

</body>

</html>